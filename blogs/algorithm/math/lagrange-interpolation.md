---
key: 2021-11-19-æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•
layout: article
title: æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•
subtitle: æ’å€¼è¿˜èƒ½ç›´æ¥ç¡®å®šå¤šé¡¹å¼ï¼ŸğŸ¤”
categories: æ•°å­¦
tags: [æ•°å­¦]
aside:
  toc: true
sidebar:
  nav: docs-en
---

# å†å²
åœ¨æ•°å€¼åˆ†æä¸­ï¼Œæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ˜¯ä»¥æ³•å›½åå…«ä¸–çºªæ•°å­¦å®¶çº¦ç‘Ÿå¤«Â·æ‹‰æ ¼æœ—æ—¥å‘½åçš„ä¸€ç§å¤šé¡¹å¼æ’å€¼æ–¹æ³•ã€‚  
è®¸å¤šå®é™…é—®é¢˜ä¸­éƒ½ç”¨å‡½æ•°æ¥è¡¨ç¤ºæŸç§å†…åœ¨è”ç³»æˆ–è§„å¾‹ï¼Œè€Œä¸å°‘å‡½æ•°éƒ½åªèƒ½é€šè¿‡å®éªŒå’Œè§‚æµ‹æ¥äº†è§£ã€‚  
å¦‚å¯¹å®è·µä¸­çš„æŸä¸ªç‰©ç†é‡è¿›è¡Œè§‚æµ‹ï¼Œåœ¨è‹¥å¹²ä¸ªä¸åŒçš„åœ°æ–¹å¾—åˆ°ç›¸åº”çš„è§‚æµ‹å€¼ï¼Œæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¤šé¡¹å¼ï¼Œå…¶æ°å¥½åœ¨å„ä¸ªè§‚æµ‹çš„ç‚¹å–åˆ°è§‚æµ‹åˆ°çš„å€¼ã€‚  
è¿™æ ·çš„å¤šé¡¹å¼ç§°ä¸ºæ‹‰æ ¼æœ—æ—¥ï¼ˆæ’å€¼ï¼‰å¤šé¡¹å¼ã€‚

# æ’å€¼
åœ¨ç¦»æ•£æ•°æ®çš„åŸºç¡€ä¸Šè¡¥æ’è¿ç»­å‡½æ•°ï¼Œä½¿å¾—è¿™æ¡è¿ç»­æ›²çº¿é€šè¿‡å…¨éƒ¨ç»™å®šçš„ç¦»æ•£æ•°æ®ç‚¹  
æ’å€¼æ˜¯ç¦»æ•£å‡½æ•°é€¼è¿‘çš„é‡è¦æ–¹æ³•ï¼Œåˆ©ç”¨å®ƒå¯é€šè¿‡å‡½æ•°åœ¨æœ‰é™ä¸ªç‚¹å¤„çš„å–å€¼çŠ¶å†µï¼Œä¼°ç®—å‡ºå‡½æ•°åœ¨å…¶ä»–ç‚¹å¤„çš„è¿‘ä¼¼å€¼

# æ„ä¹‰
ç»™å®š $n$ ä¸ªç‚¹ $(x_i,y_i)$ ï¼Œé€šè¿‡è¿™ $n$ ä¸ªç‚¹æœ€å¤šå¯ä»¥ç¡®å®šå”¯ä¸€çš„ $n-1$ æ¬¡å¤šé¡¹å¼ $f(x)$  
å½¢å¦‚ï¼š  
$$\left\{\begin{aligned}
y_1&=a_1+a_2x_1+a_3x_1^2+\cdots+a_nx_1^{n-1}\\
y_2&=a_1+a_2x_2+a_3x_2^2+\cdots+a_nx_2^{n-1}\\
\vdots&\ddots\vdots\\
y_n&=a_1+a_2x_n+x_3x_n^2+\cdots+a_nx_n^{n-1}
\end{aligned}\right.$$  
è®¡ç®— $f(k)$ çš„å€¼  
   
ç¬¬ä¸€æƒ³æ³•å¯ä»¥æ˜¯ä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒç®—å‡ºç³»æ•° $\{a\}$ å  
ç›´æ¥è®¡ç®— $f(k)=a_1+a_2k+a_3k^2+\cdots+a_nk^{n-1}$  
ä½†æ˜æ˜¾è¿™æ · $O(n^3)$ çš„å¤æ‚åº¦å¾ˆå¤šæ—¶å€™æ‰¿å—ä¸äº†  
  
è€Œæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•çš„ä½œç”¨æ˜¯**å¿«é€Ÿæ ¹æ®ç‚¹å€¼é€¼è¿‘å‡½æ•°**   

# æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•
è€ƒè™‘ä¸¤ä¸ªå¤šé¡¹å¼ç›¸å‡  
$f(k)-f(x)=(a_0-a_0)+a_1(k^1-x^1)+a_2(k^2-x^2)+\cdots+a_n(x^n-a^n)$  
å…¶ä¸­å¯¹æ¯ä¸€é¡¹ $(k^i-x^i)$ åˆ†è§£å‡èƒ½å¾—åˆ° $(k-x)$ è¿™ä¸ªå› æ•°  
å› æ­¤ $$f(k)\equiv f(x)(mod\;(k-x))$$  
é‚£ä¹ˆå¯¹äºæ±‚è§£ $f(k)$ ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡å‡ºè¿™æ ·ä¸€ä¸ªçº¿æ€§åŒä½™æ–¹ç¨‹ç»„  

$$\left\{\begin{aligned}
f(k)&\equiv y_1(mod\;(k-x_1))\\
f(k)&\equiv y_2(mod\;(k-x_2))\\
&\vdots\\
f(k)&\equiv y_n(mod\;(k-x_n))
\end{aligned}\right.$$  
æ±‚è§£çº¿æ€§åŒä½™æ–¹ç¨‹ç»„æˆ‘ä»¬åº”è¯¥æƒ³åˆ° $Crt$  
è¿™é‡Œ  
$M=\prod\limits_{i=1}^n(k-x_i)$  
$m_i=\frac M{k-x_i}=\prod\limits_{j\neq i}(k-x_j)$  
$f(x)=\sum\limits_{i=1}^ny_im_iX_i$  
å…¶ä¸­ $X_i$ æ˜¯åŒä½™æ–¹ç¨‹ $m_iX_i\equiv 1(mod\;m_i)$ çš„ä¸€ä¸ªè§£ï¼Œä¹Ÿå°±æ˜¯æ¨¡ $(k-x_i)$ æ„ä¹‰ä¸‹çš„é€†å…ƒ  
é‚£ä¹ˆè¿™ä¸ªé€†å…ƒæ€ä¹ˆæ±‚å‘¢  
$\prod\limits_{j\neq i}(k-x_j)\equiv \prod\limits_{j\neq i}(k-x_j-(k-x_i))\equiv \prod\limits_{j\neq i}(x_i-x_j)\quad(mod\; (k-x_i))$  
å³ $m_i^{-1}=\prod\limits_{j\neq i}\frac1{x_i-x_j}$  
ä»è€Œå¾—åˆ°  

$$f(k)\equiv\sum\limits_{i=1}^ny_im_im_i^{-1}\equiv\sum\limits_{i=1}^ny_i\prod_{j\neq i}\frac{k-x_j}{x_i-x_j}\quad(mod\;M)$$  
ç”±äºæ¨¡æ„ä¹‰ä¸‹ $f(k)$ å”¯ä¸€ï¼Œæ‰€ä»¥  

$$f(k)=\sum\limits_{i=1}^ny_i\prod_{j\neq i}\frac{k-x_j}{x_i-x_j}$$  
æ—¶é—´å¤æ‚åº¦ï¼š $O(n^2)$  

# é‡å¿ƒæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•  

>å¯¹äºåŠ¨æ€ç‚¹æ’å€¼é—®é¢˜ï¼Œå³ $m$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡åˆ å»ä¸€ä¸ªæ’å€¼æˆ–è€…åŠ å…¥ä¸€ä¸ªæ’å€¼ï¼Œæˆ‘ä»¬è®¡ç®— $f(k)$ çš„è¯æ—¶é—´å¤æ‚åº¦ä¸å°±å˜æˆ $O(n^2m)$ äº†ï¼Ÿ  
è¿™ä¸ªå¤æ‚åº¦æŒºé«˜çš„ï¼Œé‚£ä¹ˆå¦‚ä½•åšå‘¢ï¼Ÿ  

æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹è¿™ä¸ªå¼å­  
$f(k)=\sum\limits_{i=1}^ny_i\prod\limits_{j\neq i}\frac{k-x_j}{x_i-x_j}=\sum\limits_{i=1}^ny_i\times \frac{\prod\limits_{j=1}^n(k-x_j)}{k-x_i}\times\frac1{\prod\limits_{j\neq i}(x_i-x_j)}$   
å…¶ä¸­ $\prod\limits_{j=1}^n(k-x_j)$ å±äºé‡å¤è®¡ç®—ï¼Œä»¤å…¶è¡¨ç¤ºä¸º $\ell(k)$  
è€Œå°† $\frac1{\prod\limits_{j\neq i}(x_i-x_j)}$ å®šä¹‰ä¸º**é‡å¿ƒæƒ $w_i$**  
é‚£ä¹ˆåŸå¼å°±å˜æˆäº† $f(k)=\ell(k)\sum\limits_{i=1}^n\frac{y_iw_i}{k-x_i}$  
  
**è¿™æ ·åšçš„ä¼˜åŠ¿åœ¨äº**  
æˆ‘ä»¬æ¯æ¬¡åŠ å…¥ç‚¹æˆ–è€…åˆ å»ç‚¹ï¼Œåªéœ€è¦æ”¹å˜ $n$ ä¸ª $w_i$ çš„å€¼ï¼Œæ¯ä¸ªä¿®æ”¹ $O(1)$ å°±å¯ä»¥è§£å†³ï¼Œä¿®æ”¹ $n$ ä¸ªåªéœ€è¦ $O(n)$  
è¿˜æœ‰ $O(1)$ åœ°ä¿®æ”¹ $\ell(k)$  
åŠ ä¸Šè®¡ç®— $f(k)$ æ•´ä½“ä¹Ÿå°±æ˜¯ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ•´ä½“ç¼©å‡äº†ä¸€ä¸ªé‡çº§  

# è¿ç»­è‡ªç„¶æ•°çš„æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•  
å¯¹äº $f(k)=\sum\limits_{i=1}^ny_i\prod\limits_{j\neq i}\frac{k-x_j}{x_i-x_j}$ ,æˆ‘ä»¬å°† $x_i$ æ¢æˆ $i$  
åˆ™ $f(k)=\sum\limits_{i=1}^n\prod\limits_{j\neq i}\frac{k-j}{i-j}$  
å¯ä»¥æ³¨æ„åˆ°æ•´ä¸ª $\prod\limits_{j\neq i}\frac{k-j}{i-j}$ éƒ½æ˜¯å¯ä»¥é¢„å¤„ç†å‡ºæ¥å¿«é€Ÿè®¡ç®—çš„  
ä»¤  
$$\left\{\begin{aligned}  
&pre_i=\prod\limits_{j=0}^i(k-j)\\
&suf_i=\prod\limits_{j=i}^n(k-j)\\
&fac_i=\prod\limits_{j=1}^ij
\end{aligned}\right.$$  
  
é‚£ä¹ˆ $f(k)=\sum\limits_{i=1}^ny_i\frac{pre_{i-1}\times suf_{i+1}}{fac_{i-1}\times fac_{n-i}}$  
è¿™æ ·åšå¯ä»¥å°†æ—¶é—´å¤æ‚åº¦é™åˆ° $O(n)$   

# åº”ç”¨â€”â€”è‡ªç„¶æ•°çš„å¹‚å’Œ  
  
<p style="font-size: 22px;">æ±‚è§£ $S_k(n)=\sum\limits_{i=1}^ni^k\quad(1\le n\le10^9,\;1\le k\le10^6)$</p>  
  
é¦–å…ˆè¦çŸ¥é“è¿™æ˜¯ä¸€ä¸ª $k+1$ æ¬¡å¤šé¡¹å¼ï¼Œè¯æ˜å¦‚ä¸‹  
>è¿™é‡Œé‡‡ç”¨äºŒé¡¹å¼å®šç†è¯æ˜  
åœ¨ $k=d$ æ—¶æå‡ºä¸€é¡¹åšå·®  
$$\begin{aligned}
&(i+1)^d-i^d\\
=&\sum\limits_{j=0}\binom dji^j-i^d\\
=&\sum\limits_{j=0}^{d-1}\binom dji^j
\end{aligned}$$  
å¯¹ $(i+1)^d-i^d$ æ±‚å’Œ $=\sum\limits_{i=1}^{n-1}\sum\limits_{j=0}^{d-1}\binom dji^j=\sum\limits_{j=0}^{d-1}\binom dj\sum\limits_{i=1}^{n-1}i^j=\sum\limits_{j=0}^{d-1}\binom djS_j(n-1)$  
åŒæ—¶ç­‰å¼å·¦ä¾§ç»è¿‡ä¸¤ä¸¤ç›¸æ¶ˆä¹Ÿå¯ä»¥å¾—åˆ° $n^d-1$  
æ‰€ä»¥ $n^d-1=\sum\limits_{j=0}^{d-1}\binom djS_j(n-1)$ ,æå‡ºå³ä¾§ $j=d-1$ æ—¶å¯¹ $S_{d-1}(n-1)$  
$$\begin{aligned}
\binom d{d-1}S_d(n-1)&=n^d-\sum\limits_{j=0}^{d-2}(\binom djS_j(n-1))-1\\
S_{d-1}(n-1)&=\frac1d(n^d-\sum\limits_{j=0}^{d-2}(\binom djS_j(n-1))-1)
\end{aligned}$$  
æ­¤æ—¶æ˜¯ $S_{d-1}(n-1)$ ï¼Œæˆ‘ä»¬å°†å…¶æåˆ° $S_d(n)$  
$$\begin{aligned}
S_d(n)=&\frac1{d+1}((n+1)^{d+1}-\sum\limits_{j=0}^{d-1}(\binom{d+1}jS_j(n))-1)\\
=&\frac1{d+1}(\sum\limits_{j=0}^{d+1}\binom{d+1}jn^j-\sum\limits_{j=0}^{d-1}(\binom{d+1}jS_j(n))-1)
\end{aligned}$$  
å…¶ä¸­ $\sum\limits_{j=0}^{d+1}\binom{d+1}jn_i$ æ˜¯ä¸€ä¸ª $d+1$ æ¬¡å¤šé¡¹å¼ä¸”å°±è¿™é‡Œæ¬¡æ•°æœ€é«˜ï¼Œæ‰€ä»¥ $S_d(n)$ æ˜¯ä¸€ä¸ª $d+1$ æ¬¡å¤šé¡¹å¼  
å¾—è¯  
  
é‚£ä¹ˆåœ¨æ±‚è§£ $S_k(n)=\sum\limits_{i=1}^ni^k$ æ—¶  
æˆ‘ä»¬ä»»å– $k+2$ ä¸ªç‚¹ä»¥ç¡®å®šè¿™ä¸ª $k+1$ æ¬¡å¤šé¡¹å¼  
å³ $\{[i:1\rightarrow k+2]:(i,\sum\limits_{j=1}^ij^k)\}$  
ç”±äº $x_i$ è¿ç»­æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿ç»­è‡ªç„¶æ•°çš„æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ±‚è§£å³å¯  

