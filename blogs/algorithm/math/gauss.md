---
key: 2021-08-23-é«˜æ–¯æ¶ˆå…ƒ
layout: article
title: é«˜æ–¯æ¶ˆå…ƒ
subtitle: ç”¨çŸ©é˜µè§£æ–¹ç¨‹ï¼ŸğŸ¤”
categories: æ•°å­¦
tags: [æ•°å­¦]
aside:
  toc: true
sidebar:
  nav: docs-en
---

# é«˜æ–¯æ¶ˆå…ƒçš„ä½œç”¨

é«˜æ–¯æ¶ˆå…ƒå¯ä»¥åœ¨ $n^3$ çš„æ—¶é—´å¤æ‚åº¦ä¹‹å†…è§£ä¸€ä¸ª  
$$\left\{\begin{aligned} 
&a_{11}x_1+a_{12}x_2+...+a_{1n}x_n=b_1 \\
&a_{21}x_1+a_{22}x_2+...+a_{2n}x_n=b_2 \\
&... \\
&a_{n1}x_1+a_{n2}x_2+...+a_{nn}x_n=b_n\end{aligned}\right.$$
  
è¿™æ ·çš„å¤šå…ƒçº¿æ€§æ–¹ç¨‹ç»„  
è§£å¯ä»¥æœ‰æ— è§£ã€æ— ç©·å¤šè§£ã€å”¯ä¸€è§£

# çŸ©é˜µ

## æ€§è´¨
  
å°†ç³»æ•°æŠ½å‡ºæˆè¡Œåˆ—å¼
  
$$\left[\begin{matrix}
&a_{11}&a_{12}&...&a_{1n} \\
&a_{21}&a_{22}&...&a_{2n} \\
&...\\ &a_{n1}&a_{n2}&...&a_{nn}
\end{matrix}\right].$$  
  
ä¸‹é¢è¿™äº›å˜æ¢æ˜¯ç­‰ä»·å˜æ¢

$1.$  æŠŠæŸä¸€è¡Œä¹˜ä¸Šä¸€ä¸ªéé›¶æ•°  
$2.$  äº¤æ¢æŸä¸¤è¡Œ  
$3.$  æŠŠæŸè¡Œè‹¥å¹²å€åŠ åˆ°å¦ä¸€è¡Œä¸Šå»  

## ç›®çš„

æƒ³å˜æˆ

$$\left\{\begin{aligned} &a_{11}x_{1}&+a_{12}x_2&+...&+a_{1n}x_n&=b_1\\ &&a_{22}x_2&+...&+a_{2n}x_n&=b_2\\ &&&\;\quad...\\ &&&&\;\quad x_n&=b_n \end{aligned}\right.$$

è¿™æ ·ä¸€ä¸ªä¸Šä¸‰è§’æ–¹ç¨‹ç»„å½¢å¼  
é‚£ä¹ˆå°±å¯ä»¥ä»æœ€åä¸€ä¸ªå·²çŸ¥çš„è§£ä¸€ä¸ªä¸ªå¾€ä¸Šæ±‚å¾—åˆ«çš„è§£

## ç»“æœ

1.å®Œç¾çš„é˜¶æ¢¯å½¢ï¼šå”¯ä¸€è§£   
2.ä¸å®Œç¾é˜¶æ¢¯å½¢ï¼š$$\left\{\begin{aligned} &0=é0ï¼š&æ— è§£\\ &0=0ï¼š&æ— ç©·è§£ \end{aligned}\right.$$

# è¡Œåˆ—å¼

## è¡Œåˆ—å¼å®šä¹‰

ä¸€ä¸ª$n$é˜¶æ–¹é˜µä¹Ÿå°±æ˜¯ $A$ è¡Œåˆ—å¼çš„å€¼è®°ä¸º $det(A)$ æˆ– $|A|$  
$$det(A)=\sum\limits_P(-1)^{inv(P)}\prod\limits_iA_{1,P_1}...A_{n,P_n}$$  
$P=permutation(1...n)$  
$inv$æ˜¯å½“å‰æ’åˆ—$P$çš„é€†åºå¯¹æ•°é‡


## è¡Œåˆ—å¼æ€§è´¨ 

$1.$ äº¤æ¢è¡Œåˆ—å¼ä¸¤è¡Œ(åˆ—)ï¼Œè¡Œåˆ—å¼çš„å€¼<span style="color: red;">å˜å·</span>  
$2.$ ä¸€ä¸ªä¸Šä¸‰è§’è¡Œåˆ—å¼çš„å€¼æ˜¯<span style="color: red;">ä¸»å¯¹è§’çº¿çš„ç´¯ä¹˜</span>  
$3.$ è¡Œåˆ—å¼ä¸€è¡Œ(åˆ—)ä¹˜æˆ–é™¤ä»»æ„æ•°å€¼ä¸å½±å“æ•´ä¸ªè¡Œåˆ—å¼çš„å€¼  
$4.$ è¡Œåˆ—å¼ä¸€è¡Œ(åˆ—)å‡å»å¦ä¸€è¡Œ(åˆ—)åä¸å½±å“æ•´ä¸ªè¡Œåˆ—å¼çš„å€¼


# ä¾‹æ–¹ç¨‹ç»„ä¸è¿‡ç¨‹

$Question:$ è§£æ–¹ç¨‹
$$\left\{\begin{aligned}
&x_1+2x_2-x_3=-6\\
&2x_1+x_2-3x_3=-9\\
&-x_1-x_2+2x_3=7
\end{aligned}\right.$$

æŠ½å‡ºç³»æ•°çŸ©é˜µ  
$$\left[\begin{matrix}
&1&2&-1&6\\
&2&1&-3&-9\\
&-1&-1&2&7
\end{matrix}\right].$$
  

**é«˜æ–¯æ¶ˆå…ƒï¼š**  

æšä¸¾æ¯ä¸€åˆ—c  
$1.$  æ‰¾åˆ°å½“å‰åˆ—ç»å¯¹å€¼æœ€å¤§ä¸€è¡Œ 
$2.$  å°†è¯¥è¡Œæ¢åˆ°æœ€ä¸Šé¢  
$3.$  å°†è¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1 
$4.$  å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„å½“å‰åˆ—æ¶ˆä¸º0    
å‘ä¸Šæ¶ˆå…ƒï¼Œå°†æ¯ä¸€åˆ—åªä¿ç•™å‰é¢çš„1ï¼Œåé¢çš„æ¶ˆä¸º0 
   

$$
\left[\begin{matrix}
&2&1&-3&-9\\
&1&2&-1&6\\
&-1&-1&2&7
\end{matrix}\right].
\Rightarrow
\left[\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&1&2&-1&-6\\
&-1&-1&2&7
\end{matrix}\right].
\stackrel{\begin{aligned}
row_3+row_2\\
row_2-row_1\end{aligned}}
{\Rightarrow}\left[\begin{matrix}
&1&\frac12&-\frac32&-\frac92\\
&0&\frac32&\frac12&-\frac32\\
&0&-\frac12&\frac12&\frac52
\end{matrix}\right].$$  

$$\left[\begin{matrix} &1&\frac12&-\frac32&-\frac92\ &0&\frac32&\frac12&-\frac32\\ &0&-\frac12&\frac12&\frac52 \end{matrix}\right]. \Rightarrow \left[\begin{matrix} &1&\frac12&-\frac32&-\frac92\\ &0&1&\frac13&-1\\ &0&-\frac12&\frac12&\frac52 \end{matrix}\right]. \stackrel{row_3+\frac{row_2}2}{\Rightarrow} \left[\begin{matrix} &1&\frac12&-\frac32&-\frac92\\ &0&1&\frac13&-1\\ &0&0&\frac23&2 \end{matrix}\right].$$  

$$\left[\begin{matrix}&1&\frac12&-\frac32&-\frac92\\&0&1&\frac13&-1\\&0&0&\frac23&2\end{matrix}\right].\Rightarrow \left[\begin{matrix}&1&\frac12&-\frac32&-\frac92\\&0&1&\frac13&-1\\&0&0&1&3\end{matrix}\right].$$  

$$\left[\begin{matrix} &1&\frac12&-\frac32&-\frac92\\ &0&1&\frac13&-1\\ &0&0&1&3 \end{matrix}\right]. \stackrel{row_2-\frac{row_3}3}{\Rightarrow} \left[\begin{matrix} &1&\frac12&-\frac32&-\frac92\\ &0&1&0&-2\\ &0&0&1&3 \end{matrix}\right]. \stackrel{row\_1-\frac{row_2}3}{\Rightarrow} \left[\begin{matrix} &1&0&-\frac32&-\frac72\\ &0&1&0&-2\\ &0&0&1&3 \end{matrix}\right]. \stackrel{row_1-\frac{3*row_3}2}{\Rightarrow} \left[\begin{matrix} &1&0&0&1\\ &0&1&0&-2\\ &0&0&1&3 \end{matrix}\right].$$      

è§£å¾—æ–¹ç¨‹ï¼š$(x_1,x_2,x_3)=(1,-2,3)$

# ä¸‰ç±»é«˜æ–¯æ¶ˆå…ƒ  

## å®æ•°è§£æ–¹ç¨‹  

å®æ•°è§£æ–¹ç¨‹å°±æŒ‰ä¸Šé¢çš„æ­¥éª¤å³å¯  
æ¯æ¬¡æå‡ºæ¥æœ€å¤§çš„æ”¾åˆ°ä¸Šé¢ç„¶åå°†ä¸‹é¢çš„ä¸€åˆ—å…¨æ¶ˆæ‰  
æœ€åå†åç€æ¶ˆä¸€éå³å¯  

```cpp
inline int Gauss () {
        int c, r;
        for ( c = 0, r = 0; c < n; c ++ ) {
                int t = r;
                for ( int i = r; i < n; i ++ ) if ( fabs(a[i][c]) > fabs(a[t][c]) ) t = i;
                if ( fabs(a[t][c]) < eps ) continue;
                for ( int i = c; i <= n; i ++ ) swap(a[r][i], a[t][i]);
                for ( int i = n; i >= c; i -- ) a[r][i] /= a[r][c];
                for ( int i = r + 1; i < n; i ++ ) 
                        if ( fabs(a[i][c]) > eps )
                                for ( int j = n; j >= c; j -- ) a[i][j] -= a[r][j] * a[i][c];
                r ++;
        }
        if ( r < n ) {
                for ( int i = r; i < n; i ++ )
                        if ( fabs(a[i][n]) > eps ) return 2;
                return 1;
        }
        for ( int i = n - 1; i >= 0; i -- ) 
                for ( int j = i + 1; j < n; j ++ )
                        a[i][n] -= a[j][n] * a[i][j];
        return 0;
}
```

## æ•´æ•°è§£æ–¹ç¨‹  

æ•´æ•°è§£æ–¹ç¨‹ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºä¸èƒ½ç›´æ¥é™¤äº†  
è€Œæ˜¯åº”è¯¥ä»¥å¦ä¸€ç§æ‰‹æ®µå°†  $a_{ij}$ é€šè¿‡ $a_{ii}$  å˜æˆ $0$   
å¯ä»¥å°†  $a_{ii}$ å’Œ  $a_{ij}$ éƒ½å˜æˆ $lcm(a_{ii},a_{ij})$ ï¼ˆæ³¨æ„åŒè¡Œé‡Œé¢åˆ«çš„ä¹Ÿè¦ä¹˜å¯¹åº”è¦ä¹˜çš„æ•°  
ç„¶åå†è¿›è¡Œä¸¤è¡Œç›¸å‡å³å¯  

```cpp
inline int Gcd ( int a, int b ) { return b ? Gcd ( b, a % b ) : a; }
inline void Gauss () {
        for ( int r = 0, c = 0; c < n; c ++ ) {
                int t = r;
                for ( int i = r; i < n; i ++ ) if ( abs(A[i][c]) > abs(A[t][c]) ) t = i;
                if ( A[t][c] == 0 ) continue;
                swap ( A[r], A[t] ); 
                for ( int i = 0; i < n; i ++ ) {
                        if ( i == r ) continue;
                        if ( A[i][c] ) {
                                int t1 = A[i][c] / Gcd ( A[i][c], A[r][c] );
                                int t2 = A[r][c] / Gcd ( A[i][c], A[r][c] );
                                for ( int j = 0; j < n; j ++ ) 
                                        A[r][j] *= t1, 
                                        A[i][j] = A[i][j] * t2 - A[r][j];
                        }
                }
                r ++;
        }
}
```

## æ•´æ•°è§£è¡Œåˆ—å¼

é«˜æ–¯æ¶ˆå…ƒå¯ä»¥å°†ä¸€ä¸ªè¡Œåˆ—å¼<mark>ä¸»å¯¹è§’çº¿ä¸‹é¢çš„éƒ¨åˆ†è§£æˆå…¨éƒ¨æ˜¯0</mark>çš„æƒ…å†µ   
åœ¨è¿™é‡Œæˆ‘ä»¬è¦å®Œæ•´åœ°è§£å‡ºä¸€ä¸ªå…¨éƒ¨éƒ½æ˜¯æ•´æ•°çš„è¡Œåˆ—å¼çš„æ•´æ•°å€¼  
ç”±äºè¾—è½¬ç›¸é™¤æ³•æ˜¯å¯ä»¥å°†ç¬¬äºŒä¸ªå…ƒç´ æ¶ˆåˆ°$0$ï¼Œæ‰€ä»¥å¯ä»¥<mark>ç»“åˆè¾—è½¬ç›¸é™¤æ³•</mark>ä½¿ç”¨  
å¯¹äºä¸€ä¸ªæˆ‘ä»¬æƒ³è¦é€šè¿‡ç¬¬$A_{jj}$ä¸ªå•ä½æ¶ˆåˆ°$0$çš„å•ä½$A_{ij}$  
æˆ‘ä»¬å¯ä»¥åªè€ƒè™‘ä»–ä»¬ä¸¤ä¸ªï¼Œä½†æ˜¯ç”±äºæ“ä½œæ—¶ä¸ºäº†ä¿è¯è¡Œåˆ—å¼å€¼çš„æ­£ç¡®æ€§æˆ‘ä»¬è¦<span style="color: red;">æ“ä½œæ•´è¡Œ</span>  
æ‰€ä»¥è®°å½•ä¸€ä¸‹$A_{jj}$é™¤$A_{ij}$åå‘ä¸‹å–æ•´åçš„å€¼$d$ï¼Œå¯¹äºè¿™ä¸ªä¸¤ä¸ªæˆ‘ä»¬è®©$A_{jj}-=A_{ij}\times d$ä¾¿å¯å®ç°å–æ¨¡æ“ä½œï¼Œç„¶åå¯¹äºè¿™ä¸¤è¡Œæ¯ä¸€åˆ—çš„ä¸¤ä¸ªå•ä½è¿›è¡ŒåŒæ ·çš„æ“ä½œ  
æœ€åå†äº’æ¢ä¸€ä¸‹ï¼Œç›´åˆ°æˆ‘ä»¬è¦æ¶ˆçš„å…ƒç´ å˜æˆ0ä¸ºæ­¢


```cpp
inline int Gauss ( int n ) {
	int res = 1;
	for ( int i = 1; i <= n; i ++ ) { // åœ¨(i, i)ä¸Šè¿›è¡Œæ¶ˆå…ƒ
		for ( int ii = i + 1; ii <= n; ii ++ ) { // å°†(ii, i)å˜æˆ0
			while ( a[ii][i] ) { // è¿˜æ²¡æœ‰æ¶ˆåˆ° 0
				int d = a[i][i] / a[ii][i];
				for ( int j = i; j <= n; j ++ )
					a[i][j] = (a[i][j] - (ll)d * a[ii][j] % mod + mod) % mod,
					swap ( a[i][j], a[ii][j] );
				res = -res; // è¡Œ(åˆ—)äº’æ¢æœ€åçš„å€¼è¦ç›¸å
			}
		}
		res = (ll)res * a[i][i] % mod; // ä¹˜å¯¹è§’çº¿
		if ( res == 0 ) return 0;
	}
	return (res % mod + mod) % mod;
}
```

# ä¾‹é¢˜

**æ´›è°·P4035_çƒå½¢ç©ºé—´äº§ç”Ÿå™¨**  
[é¢˜ç›®åœ°å€](https://www.luogu.com.cn/problem/P4035)  
[é¢˜è§£åœ°å€](https://github.com/Chivas-Regal/ACM/blob/main/Code/%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/%E7%90%83%E5%BD%A2%E7%A9%BA%E9%97%B4%E4%BA%A7%E7%94%9F%E5%99%A8.md)  
  
**æ´›è°·P7112_è¡Œåˆ—å¼æ±‚å€¼**  
[é¢˜ç›®åœ°å€](https://www.luogu.com.cn/problem/P7112)  
[é¢˜è§£åœ°å€]()   
  
**æ´›è°·P1092_è™«é£Ÿç®—**  
[é¢˜ç›®åœ°å€](https://www.luogu.com.cn/problem/P1092)  
[é¢˜è§£åœ°å€]()   

